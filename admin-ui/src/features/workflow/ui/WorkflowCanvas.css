.workflow-canvas {
  width: 100%;
  height: 100%;
  min-height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--bg-primary, #0a0a0f);
}

.workflow-canvas .react-flow__edge-path {
  stroke-width: 2;
}

.workflow-canvas .react-flow__edge.animated .react-flow__edge-path {
  stroke-dasharray: 5;
  animation: flow 0.5s linear infinite;
}

@keyframes flow {
  from { stroke-dashoffset: 10; }
  to { stroke-dashoffset: 0; }
}

/* 컨트롤 스타일링 */
.workflow-controls {
  background: var(--bg-secondary, #12121a);
  border: 1px solid var(--border-color, #2a2a3a);
  border-radius: 8px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
}

.workflow-controls button {
  background: var(--bg-primary, #0a0a0f);
  border: none;
  border-bottom: 1px solid var(--border-color, #2a2a3a);
  color: var(--text-primary, #f0f0f0);
  width: 28px;
  height: 28px;
}

.workflow-controls button:last-child {
  border-bottom: none;
}

.workflow-controls button:hover {
  background: var(--bg-tertiary, #1a1a2a);
}

.workflow-controls button svg {
  fill: var(--text-primary, #f0f0f0);
}

/* 미니맵 스타일링 */
.workflow-minimap {
  background: var(--bg-secondary, #12121a);
  border: 1px solid var(--border-color, #2a2a3a);
  border-radius: 8px;
}

.workflow-minimap .react-flow__minimap-mask {
  fill: rgba(0, 0, 0, 0.8);
}

/* 범례 */
.workflow-legend {
  background: rgba(10, 10, 15, 0.95);
  border: 1px solid var(--border-color, #2a2a3a);
  border-radius: 8px;
  padding: 12px 16px;
  backdrop-filter: blur(8px);
}

.legend-section {
  margin-bottom: 10px;
}

.legend-section:last-child {
  margin-bottom: 0;
}

.legend-title {
  font-size: 0.6rem;
  text-transform: uppercase;
  color: var(--text-muted, #666);
  margin-bottom: 6px;
  letter-spacing: 0.1em;
  font-weight: 700;
}

.legend-items {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
}

/* NODE TYPES - 채워진 원 */
.legend-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
}

/* STATUS - 테두리만 있는 링 */
.legend-ring {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: transparent;
  border: 2px solid;
  box-sizing: border-box;
}

.legend-label {
  font-size: 0.7rem;
  color: var(--text-secondary, #a0a0a0);
  text-transform: capitalize;
}

/* React Flow 기본 스타일 오버라이드 */
.workflow-canvas .react-flow__attribution {
  display: none;
}

.workflow-canvas .react-flow__pane {
  cursor: grab;
}

.workflow-canvas .react-flow__pane:active {
  cursor: grabbing;
}

/* ==================== SOTA급 엣지 스타일 ==================== */

/* 기본 엣지 */
.workflow-canvas .react-flow__edge {
  pointer-events: all;
}

.workflow-canvas .react-flow__edge-path {
  stroke-width: 2;
  transition: stroke-width 0.2s ease, stroke 0.2s ease;
}

.workflow-canvas .react-flow__edge:hover .react-flow__edge-path {
  stroke: #00d4ff;
  stroke-width: 3;
  filter: drop-shadow(0 0 4px rgba(0, 212, 255, 0.6));
}

/* DASHED 엣지 (Join/Fanout 관계) - Cross-entity 연결 강조 */
.workflow-canvas .react-flow__edge[style*="dashed"] .react-flow__edge-path {
  stroke-linecap: round;
  filter: drop-shadow(0 0 2px rgba(136, 85, 255, 0.4));
}

.workflow-canvas .react-flow__edge[style*="dashed"]:hover .react-flow__edge-path {
  stroke: #aa77ff;
  filter: drop-shadow(0 0 6px rgba(170, 119, 255, 0.8));
}

/* Animated 엣지 (활성 흐름) */
.workflow-canvas .react-flow__edge.animated .react-flow__edge-path {
  stroke-dasharray: 8 4;
  animation: edgeFlow 0.8s linear infinite;
}

@keyframes edgeFlow {
  from { stroke-dashoffset: 12; }
  to { stroke-dashoffset: 0; }
}

/* 엣지 호버 시 라벨도 강조 */
.workflow-canvas .react-flow__edge:hover + .edge-label {
  transform: scale(1.1);
}

/* Dimmed 노드 스타일 (선택 시 연결되지 않은 노드) */
.workflow-canvas .react-flow__node.dimmed {
  opacity: 0.15;
  filter: grayscale(80%);
  transition: opacity 0.3s ease, filter 0.3s ease;
  pointer-events: none;
}

/* 연결된 노드는 밝게 */
.workflow-canvas .react-flow__node:not(.dimmed) {
  transition: opacity 0.3s ease, filter 0.3s ease;
}

/* 선택된 노드 강조 */
.workflow-canvas .react-flow__node.selected {
  z-index: 10;
}

.workflow-canvas .react-flow__node.selected::after {
  content: '';
  position: absolute;
  top: -4px;
  left: -4px;
  right: -4px;
  bottom: -4px;
  border: 2px solid #00d4ff;
  border-radius: 12px;
  box-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
  pointer-events: none;
}
