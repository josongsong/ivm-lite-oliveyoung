# RFC-IMPL-016: Brand RuleSet
# Brand 엔티티의 슬라이싱 규칙 정의
#
# RefIndexSlice 패턴:
# - CORE: 전체 Brand 데이터 (상세 페이지용)
# - SUMMARY: 경량 참조용 (Product ENRICHED에서 LOOKUP)

kind: RULESET
id: ruleset.brand.v1
version: 1.0.0
status: ACTIVE

entityType: BRAND

# 변경 경로 → 영향 슬라이스 (SSOT)
# Brand의 어떤 필드가 변경되면 어떤 슬라이스를 재빌드할지 정의
impactMap:
  CORE:
    - "/brandId"
    - "/name"
    - "/logoUrl"
    - "/description"
    - "/country"
    - "/website"
  SUMMARY:
    - "/brandId"
    - "/name"
    - "/logoUrl"

# 최상위 조인 (Brand는 다른 엔티티를 참조하지 않음)
joins: []

slices:
  # 1. CORE: 전체 Brand 데이터 (Brand 상세 페이지용)
  - type: CORE
    buildRules:
      type: PassThrough
      fields:
        - "*"

  # 2. SUMMARY: 경량 참조용 (REF_INDEX)
  #    - Product ENRICHED에서 LOOKUP 대상
  #    - name, logoUrl만 포함 (고빈도 참조 필드 최소화)
  #    - Brand 이름/로고만 바뀌면 SUMMARY만 변경 → Product ENRICHED만 재빌드
  - type: SUMMARY
    sliceKind: REF_INDEX
    buildRules:
      type: MapFields
      mappings:
        - from: brandId
          to: id
        - from: name
          to: name
        - from: logoUrl
          to: logoUrl

# Brand는 다른 엔티티의 참조 대상이므로 역참조 인덱스 불필요
# (Product가 Brand를 참조하고, Product RuleSet에 brand index 정의)
indexes: []
